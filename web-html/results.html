<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Results - Telescope</title>
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
  <div id="root">
    <div class="app">
      <div class="logo-container">
        <img src="/assets/vite.svg" alt="Logo" class="logo" />
      </div>

      <nav class="common-nav">
        <span class="nav-link disabled">Overview</span>
        <span class="nav-link disabled">Metrics</span>
        <span class="nav-link disabled">Resources</span>
        <span class="nav-link disabled">Waterfall</span>
        <span class="nav-link disabled">Filmstrip</span>
        <span class="nav-link disabled">Video</span>
        <span class="nav-link disabled">Console</span>
        <span class="nav-link disabled">Bottlenecks</span>
        <span class="nav-link disabled">Config</span>
      </nav>

      <header>
        <div class="tabs">
          <a href="/" class="tab">Simple</a>
          <a href="/advanced.html" class="tab">Advanced</a>
          <a href="/results.html" class="tab active">Results</a>
          <a href="/upload.html" class="tab">Upload</a>
        </div>
      </header>

      <main>
        <div class="content">
          <div class="section-content">
            <h2>Test Results</h2>
            <p>View all performance test results:</p>
            <div id="results-container">
              <p>Loading...</p>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script type="module">
    const container = document.getElementById('results-container');

    async function loadResults() {
      try {
        const response = await fetch('/api/results');
        const data = await response.json();
        const results = data.results || [];

        if (results.length === 0) {
          container.innerHTML = `
            <div style="margin-top: 2rem; padding: 2rem; background: var(--color-background-lighter); border-radius: var(--border-radius-md); text-align: center;">
              No test results available yet.
            </div>
          `;
        } else {
          container.innerHTML = results.map(result => `
            <a href="/result/overview.html?testId=${result.testId}" style="display: flex; gap: 1rem; padding: 1rem; margin-bottom: 1rem; background: var(--color-white); border: 1px solid var(--color-border-lighter); border-radius: var(--border-radius-md); text-decoration: none; color: inherit;">
              ${result.screenshotUrl ? `
                <img src="${result.screenshotUrl}" alt="Screenshot" style="width: 120px; height: 80px; object-fit: cover; border-radius: var(--border-radius-md); border: 1px solid var(--color-border-lighter);" />
              ` : ''}
              <div style="flex: 1;">
                <div style="font-size: 0.875rem; color: var(--color-text-secondary); margin-bottom: 0.5rem; font-family: monospace; background: var(--color-background-lighter); padding: 0.25rem 0.5rem; border-radius: var(--border-radius-sm); display: inline-block;">
                  ${result.url}
                </div>
                <div style="display: flex; gap: 1rem; font-size: 0.875rem; color: var(--color-text-secondary);">
                  <div><strong>Browser:</strong> ${result.browser}</div>
                  ${result.timestamp ? `<div><strong>Date:</strong> ${new Date(result.timestamp).toLocaleString()}</div>` : ''}
                </div>
              </div>
            </a>
          `).join('');
        }
      } catch (err) {
        container.innerHTML = '<p style="color: var(--color-text-secondary);">Failed to load results.</p>';
      }
    }

    loadResults();
  </script>
</body>
</html>

